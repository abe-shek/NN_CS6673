\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    \usepackage[utf8]{inputenc}
    

   \DeclareUnicodeCharacter{03B1}{\ensuremath{\alpha}}
   \DeclareUnicodeCharacter{03B6}{\ensuremath{\zeta}}
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{NNC\_Final\_Project\_Code\_Demo}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} CS6673 Neural Network Computing}
\PY{c+c1}{\PYZsh{} Final Project}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} Note (IMPORTANT! Please Read!)}
\PY{c+c1}{\PYZsh{} 1. The results generated by part2\PYZam{}3 will be slightly different from the }
\PY{c+c1}{\PYZsh{} result included in the report due to random initialization of weight\PYZam{}bias}
\PY{c+c1}{\PYZsh{} before training.}
\PY{c+c1}{\PYZsh{} 2. For part 4, we use the weight/bias provided for part1}
\PY{c+c1}{\PYZsh{}}
\PY{c+c1}{\PYZsh{}}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Note (IMPORTANT! Please Read!)}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ 1. The results generated by part2\PYZam{}3 will be slightly different from the result }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ included in the report due to random initialization of weight\PYZam{}bias for each run.}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{ 2. For Part 4, we use the weight/bias provided for part1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Note (IMPORTANT! Please Read!)
 1. The results generated by part2\&3 will be slightly different from the result
 included in the report due to random initialization of weight\&bias for each
run.
 2. For Part 4, we use the weight/bias provided for part1
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{getopt}
\PY{k+kn}{import} \PY{n+nn}{sys}

\PY{k}{class} \PY{n+nc}{Model}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{n0}\PY{p}{,} \PY{n}{n1}\PY{p}{,} \PY{n}{n2}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}0} \PY{o}{=} \PY{n}{n0}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1} \PY{o}{=} \PY{n}{n1}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}2} \PY{o}{=} \PY{n}{n2}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{reinitialize\PYZus{}weights} \PY{o}{=} \PY{k+kc}{True}
        
        \PY{c+c1}{\PYZsh{} weights and biases initialized as placeholders.}
        \PY{c+c1}{\PYZsh{} reinitialized later}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{weights\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{weights\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}2}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{biases\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{biases\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}2}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{activations\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{activations\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}2}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sensitivities\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sensitivities\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{n\PYZus{}2}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hyper\PYZus{}params} \PY{o}{=} \PY{n}{HyperParams}\PY{p}{(}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model\PYZus{}info} \PY{o}{=} \PY{n}{Info}\PY{p}{(}\PY{p}{)}


\PY{k}{class} \PY{n+nc}{HyperParams}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{no\PYZus{}training\PYZus{}steps}\PY{o}{=}\PY{l+m+mi}{800}\PY{p}{,} \PY{n}{alpha\PYZus{}sch}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{percentage}\PY{o}{=}\PY{l+m+mf}{0.98}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{zeta\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{1.5}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x0\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{1.5}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{max\PYZus{}epochs} \PY{o}{=} \PY{l+m+mi}{700}  \PY{c+c1}{\PYZsh{} empirically chosen}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tolerance} \PY{o}{=} \PY{l+m+mf}{0.05}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{training\PYZus{}steps} \PY{o}{=} \PY{n}{no\PYZus{}training\PYZus{}steps}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{learning\PYZus{}rate} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lr\PYZus{}scheduling\PYZus{}option} \PY{o}{=} \PY{n}{alpha\PYZus{}sch}  \PY{c+c1}{\PYZsh{} \PYZob{}0: no\PYZus{}sch, 1: step\PYZus{}sch, 2: per\PYZus{}sch\PYZcb{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lr\PYZus{}perc\PYZus{}decrease} \PY{o}{=} \PY{n}{percentage}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{zeta} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{zeta\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x0} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x0\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{=} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{} \PYZob{}0: quadratic, 1: cross\PYZhy{}entropy\PYZcb{}}

\PY{k}{class} \PY{n+nc}{Info}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{total\PYZus{}epochs}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{last\PYZus{}epoch\PYZus{}error}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{n}{convergence}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{total\PYZus{}epochs\PYZus{}req} \PY{o}{=} \PY{n}{total\PYZus{}epochs}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{last\PYZus{}epoch\PYZus{}error} \PY{o}{=} \PY{n}{last\PYZus{}epoch\PYZus{}error}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{converged} \PY{o}{=} \PY{n}{convergence}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{n}{sheets} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{k}{def} \PY{n+nf}{update\PYZus{}sheet}\PY{p}{(}\PY{n}{writer}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{sheet\PYZus{}obj}\PY{p}{)}\PY{p}{:}
    \PY{n}{df\PYZus{}obj} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model architecture}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}arch\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model weights}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}weight\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model biases}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}bias\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Training epochs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}epochs\PYZus{}req\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Learning Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zeta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zeta\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x0\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cost Function}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}fn\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Last epoch error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last\PYZus{}epoch\PYZus{}error\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Did converge?}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{converged\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
    \PY{p}{\PYZcb{}}
    \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df\PYZus{}obj}\PY{p}{)}
    \PY{n}{df}\PY{o}{.}\PY{n}{to\PYZus{}excel}\PY{p}{(}\PY{n}{writer}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{save\PYZus{}data}\PY{p}{(}\PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{k}{try}\PY{p}{:}
        \PY{n}{sheet\PYZus{}obj} \PY{o}{=} \PY{n}{sheets}\PY{p}{[}\PY{n}{sheet\PYZus{}name}\PY{p}{]}
    \PY{k}{except} \PY{n+ne}{KeyError}\PY{p}{:}
        \PY{n}{sheet\PYZus{}obj} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{sheet\PYZus{}obj}\PY{p}{:}
        \PY{n}{sheet\PYZus{}obj} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}arch\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}weight\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}bias\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}epochs\PYZus{}req\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zeta\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x0\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}fn\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last\PYZus{}epoch\PYZus{}error\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{converged\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{\PYZcb{}}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}arch\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{[ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}0}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}1}\PY{p}{)} \PY{o}{+}
                                        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}2}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}weight\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights1 = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{p}{)} \PY{o}{+}
                                          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Weights2 = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{p}{)}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}bias\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biases1 = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{p}{)} \PY{o}{+}
                                        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Biases2 = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{p}{)}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}epochs\PYZus{}req\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{total\PYZus{}epochs\PYZus{}req}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{learning\PYZus{}rate}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zeta\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x0\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}fn\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quadratic}\PY{l+s+s2}{\PYZdq{}} \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{==} \PY{l+m+mi}{0}
                                     \PY{k}{else} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cross\PYZhy{}Entropy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last\PYZus{}epoch\PYZus{}error\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{last\PYZus{}epoch\PYZus{}error}\PY{p}{)}
    \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{converged\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Yes}\PY{l+s+s2}{\PYZdq{}} \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{converged} \PY{k}{else} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sheets}\PY{p}{[}\PY{n}{sheet\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{sheet\PYZus{}obj}

\PY{k}{def} \PY{n+nf}{export\PYZus{}data}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Starting export}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{writer} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{ExcelWriter}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Results.xlsx}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xlsxwriter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{writer}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Error while opening writer. Exiting.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{return}
    \PY{k}{for} \PY{n}{sheet\PYZus{}name} \PY{o+ow}{in} \PY{n}{sheets}\PY{p}{:}
        \PY{n}{sheet\PYZus{}obj} \PY{o}{=} \PY{n}{sheets}\PY{p}{[}\PY{n}{sheet\PYZus{}name}\PY{p}{]}
        \PY{k}{if} \PY{o+ow}{not} \PY{n}{sheet\PYZus{}obj}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Skipping sheet \PYZhy{} }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sheet\PYZus{}name}\PY{p}{)}
            \PY{k}{continue}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Updating sheet \PYZhy{} }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sheet\PYZus{}name}\PY{p}{)}
        \PY{n}{update\PYZus{}sheet}\PY{p}{(}\PY{n}{writer}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{sheet\PYZus{}obj}\PY{p}{)}
    \PY{n}{writer}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data exported}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{print\PYZus{}table\PYZus{}a}\PY{p}{(}\PY{n}{sheet\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{k}{global} \PY{n}{sheets}
    \PY{k}{try}\PY{p}{:}
        \PY{n}{sheet\PYZus{}obj} \PY{o}{=} \PY{n}{sheets}\PY{p}{[}\PY{n}{sheet\PYZus{}name}\PY{p}{]}
        \PY{n}{simple\PYZus{}table} \PY{o}{=} \PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zeta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zeta\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X}\PY{l+s+se}{\PYZbs{}u2080}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x0\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Final Epoch Error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last\PYZus{}epoch\PYZus{}error\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Convergence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{converged\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Training Epochs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sheet\PYZus{}obj}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}epochs\PYZus{}req\PYZus{}list}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{\PYZcb{}}
        \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{simple\PYZus{}table}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{)}
    \PY{k}{except} \PY{n+ne}{KeyError}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Sheet doesn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t exist}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{transfer\PYZus{}ftn}\PY{p}{(}\PY{n}{n\PYZus{}l}\PY{p}{,} \PY{n}{x0}\PY{p}{)}\PY{p}{:}
    \PY{n}{a\PYZus{}l} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tanh}\PY{p}{(}\PY{n}{n\PYZus{}l} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{x0}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{a\PYZus{}l}

\PY{c+c1}{\PYZsh{} we only save a\PYZus{}l NOT n\PYZus{}l if using bipolar sigmoid transfer function}
\PY{k}{def} \PY{n+nf}{derivative\PYZus{}transfer\PYZus{}ftn}\PY{p}{(}\PY{n}{a\PYZus{}l}\PY{p}{,} \PY{n}{x0}\PY{p}{)}\PY{p}{:}
    \PY{n}{derivative} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{a\PYZus{}l}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{a\PYZus{}l}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{x0}\PY{p}{)}
    \PY{k}{return} \PY{n}{derivative}

\PY{k}{def} \PY{n+nf}{init\PYZus{}weights\PYZus{}biases}\PY{p}{(}\PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{reinitialize\PYZus{}weights}\PY{p}{:}
        \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,}
                                            \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,}
                                            \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,}
                                           \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{*} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,}
                                           \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{k}{return} \PY{p}{[}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{p}{]}

\PY{k}{def} \PY{n+nf}{train\PYZus{}nn}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{n}{Q} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
    \PY{n}{weight\PYZus{}list}\PY{p}{,} \PY{n}{bias\PYZus{}list} \PY{o}{=} \PY{n}{init\PYZus{}weights\PYZus{}biases}\PY{p}{(}\PY{n}{model}\PY{p}{)}
    \PY{n}{weight\PYZus{}list\PYZus{}len} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{weight\PYZus{}list}\PY{p}{)}
    \PY{k}{for} \PY{n}{epoch} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{max\PYZus{}epochs}\PY{p}{)}\PY{p}{:}
        \PY{n}{epoch\PYZus{}error} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{iteration} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{Q}\PY{p}{)}\PY{p}{:}
            \PY{n}{x} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{n}{iteration}\PY{p}{]}
            \PY{n}{y} \PY{o}{=} \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{n}{iteration}\PY{p}{]}
            \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Calculate activations for all layers}
            \PY{c+c1}{\PYZsh{} don\PYZsq{}t need to save n\PYZus{}l if we are using bipolar sigmoid transfer function}
            \PY{n}{a\PYZus{}l\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{]}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{weight\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{n\PYZus{}l} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{a\PYZus{}l\PYZus{}list}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{bias\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                \PY{n}{a\PYZus{}l} \PY{o}{=} \PY{n}{transfer\PYZus{}ftn}\PY{p}{(}\PY{n}{n\PYZus{}l}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0}\PY{p}{)}
                \PY{n}{a\PYZus{}l\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{a\PYZus{}l}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} calculating the error for this example}
            \PY{n}{y\PYZus{}hat} \PY{o}{=} \PY{n}{a\PYZus{}l\PYZus{}list}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}  \PY{c+c1}{\PYZsh{} activation of the last layer}
            \PY{n}{example\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{y\PYZus{}hat} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{,} \PY{p}{(}\PY{n}{y\PYZus{}hat} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)}\PY{o}{.}\PY{n}{T}\PY{p}{)}
            \PY{n}{example\PYZus{}error} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asscalar}\PY{p}{(}\PY{n}{example\PYZus{}error}\PY{p}{)}
            \PY{n}{epoch\PYZus{}error} \PY{o}{=} \PY{n}{epoch\PYZus{}error} \PY{o}{+} \PY{n}{example\PYZus{}error}

            \PY{c+c1}{\PYZsh{} Calculate sensitivities for last layer. Performs element\PYZhy{}wise multiplication.}
            \PY{c+c1}{\PYZsh{} quadratic cost function}
            \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                \PY{n}{s\PYZus{}L} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{multiply}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}hat} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{n}{derivative\PYZus{}transfer\PYZus{}ftn}\PY{p}{(}\PY{n}{y\PYZus{}hat}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0}\PY{p}{)}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} cross entropy cost function}
            \PY{k}{elif} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{n}{s\PYZus{}L} \PY{o}{=} \PY{n}{y\PYZus{}hat} \PY{o}{\PYZhy{}} \PY{n}{y}

            \PY{c+c1}{\PYZsh{} Calculate sensitivites for other layers}
            \PY{n}{sensitivities\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{s\PYZus{}L}\PY{p}{]}

            \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{weight\PYZus{}list\PYZus{}len} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                \PY{n}{s\PYZus{}l} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{multiply}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{sensitivities\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{,} \PYZbs{}
                                  \PY{n}{derivative\PYZus{}transfer\PYZus{}ftn}\PY{p}{(}\PY{n}{a\PYZus{}l\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0}\PY{p}{)}\PY{p}{)}
                \PY{n}{sensitivities\PYZus{}list}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{s\PYZus{}l}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Update weights and biases}
            \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{weight\PYZus{}list\PYZus{}len}\PY{p}{)}\PY{p}{:}
                \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]} \PY{o}{=} \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]} \PY{o}{\PYZhy{}} \PYZbs{}
                                 \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{learning\PYZus{}rate} \PY{o}{*}
                                  \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{a\PYZus{}l\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{o}{.}\PY{n}{T}\PY{p}{,} \PY{n}{sensitivities\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{p}{)}\PY{p}{)}

                \PY{n}{bias\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]} \PY{o}{=} \PY{n}{bias\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]} \PY{o}{\PYZhy{}} \PYZbs{}
                               \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{learning\PYZus{}rate} \PY{o}{*} \PY{n}{sensitivities\PYZus{}list}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} epoch error is not normalized (not divided by number of examples)}
        \PY{k}{if} \PY{n}{epoch\PYZus{}error} \PY{o}{\PYZlt{}} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{tolerance}\PY{p}{:}
            \PY{k}{break}

    \PY{n}{num\PYZus{}training\PYZus{}epochs} \PY{o}{=} \PY{n}{epoch} \PY{o}{+} \PY{l+m+mi}{1}
    \PY{k}{if} \PY{n}{num\PYZus{}training\PYZus{}epochs} \PY{o}{\PYZlt{}} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{max\PYZus{}epochs}\PY{p}{:}
        \PY{n}{convergence} \PY{o}{=} \PY{k+kc}{True}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{convergence} \PY{o}{=} \PY{k+kc}{False}
    \PY{n}{update\PYZus{}model\PYZus{}info}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{weight\PYZus{}list}\PY{p}{,} \PY{n}{bias\PYZus{}list}\PY{p}{,} \PY{n}{num\PYZus{}training\PYZus{}epochs}\PY{p}{,} \PY{n}{epoch\PYZus{}error}\PY{p}{,} \PY{n}{convergence}\PY{p}{)}
    \PY{k}{return} \PY{n}{model}

\PY{k}{def} \PY{n+nf}{update\PYZus{}model\PYZus{}info}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{weight\PYZus{}list}\PY{p}{,} \PY{n}{bias\PYZus{}list}\PY{p}{,} \PY{n}{num\PYZus{}training\PYZus{}epochs}\PY{p}{,} \PY{n}{epoch\PYZus{}error}\PY{p}{,} \PY{n}{convergence}\PY{p}{)}\PY{p}{:}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1} \PY{o}{=} \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2} \PY{o}{=} \PY{n}{weight\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1} \PY{o}{=} \PY{n}{bias\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2} \PY{o}{=} \PY{n}{bias\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{total\PYZus{}epochs\PYZus{}req} \PY{o}{=} \PY{n}{num\PYZus{}training\PYZus{}epochs}
    \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{last\PYZus{}epoch\PYZus{}error} \PY{o}{=} \PY{n}{epoch\PYZus{}error}
    \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{converged} \PY{o}{=} \PY{n}{convergence}

\PY{k}{def} \PY{n+nf}{extract\PYZus{}model\PYZus{}info}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{export\PYZus{}to\PYZus{}excel}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{verbose}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Learning rate = }\PY{l+s+si}{\PYZob{}model.hyper\PYZus{}params.learning\PYZus{}rate\PYZcb{}}\PY{l+s+s2}{ | }\PY{l+s+s2}{\PYZdq{}}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Zeta = }\PY{l+s+si}{\PYZob{}model.hyper\PYZus{}params.zeta\PYZcb{}}\PY{l+s+s2}{ | }\PY{l+s+s2}{\PYZdq{}}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x0 = }\PY{l+s+si}{\PYZob{}model.hyper\PYZus{}params.x0\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Convergence = }\PY{l+s+si}{\PYZob{}model.model\PYZus{}info.converged\PYZcb{}}\PY{l+s+s2}{ | }\PY{l+s+s2}{\PYZdq{}}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Training Epochs = }\PY{l+s+si}{\PYZob{}model.model\PYZus{}info.total\PYZus{}epochs\PYZus{}req\PYZcb{}}\PY{l+s+s2}{ | }\PY{l+s+s2}{\PYZdq{}}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Squared Error = }\PY{l+s+si}{\PYZob{}model.model\PYZus{}info.last\PYZus{}epoch\PYZus{}error\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{elif} \PY{n}{export\PYZus{}to\PYZus{}excel}\PY{p}{:}
        \PY{n}{save\PYZus{}data}\PY{p}{(}\PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{model}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{part\PYZus{}2a}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{table}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} TODO}
    \PY{c+c1}{\PYZsh{} Look for patterns when do we get non\PYZhy{}convergent results}
    \PY{c+c1}{\PYZsh{} Try all 3X3X3=27 hyper parameter combinations of alpha, zeta and x0}
    \PY{n}{num\PYZus{}convergence} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{for} \PY{n}{alpha} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{alpha\PYZus{}list}\PY{p}{:}
        \PY{k}{for} \PY{n}{zeta} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta\PYZus{}list}\PY{p}{:}
            \PY{k}{for} \PY{n}{x0} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0\PYZus{}list}\PY{p}{:}
                \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{learning\PYZus{}rate} \PY{o}{=} \PY{n}{alpha}
                \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta} \PY{o}{=} \PY{n}{zeta}
                \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0} \PY{o}{=} \PY{n}{x0}
                \PY{n}{model} \PY{o}{=} \PY{n}{train\PYZus{}nn}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}
                \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{converged}\PY{p}{:}
                    \PY{n}{num\PYZus{}convergence} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{c+c1}{\PYZsh{} extract\PYZus{}model\PYZus{}info(model, sheet\PYZus{}name, verbose=True)}
                \PY{n}{extract\PYZus{}model\PYZus{}info}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)} \PY{c+c1}{\PYZsh{} for demo purpose}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of convergent hyper parameter combinations = }\PY{l+s+si}{\PYZob{}num\PYZus{}convergence\PYZcb{}}\PY{l+s+s2}{ (out of 27)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{part\PYZus{}2b}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cost\PYZus{}fn}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{table}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{n}{N1\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
    \PY{n}{convergence\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{N1\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{model} \PY{o}{=} \PY{n}{Model}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{N1\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{=} \PY{n}{cost\PYZus{}fn}
        \PY{n}{num\PYZus{}convergence} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{iters} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{train\PYZus{}nn}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}
            \PY{k}{if} \PY{n}{model}\PY{o}{.}\PY{n}{model\PYZus{}info}\PY{o}{.}\PY{n}{converged}\PY{p}{:}
                \PY{n}{num\PYZus{}convergence} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
            \PY{n}{extract\PYZus{}model\PYZus{}info}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        \PY{n}{convergence\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{num\PYZus{}convergence}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Convergence for N1 = }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{ \PYZhy{}\PYZgt{} }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{N1\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}convergence}\PY{p}{)}\PY{p}{)}

    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Convergence results for N1 = [1,2,4,6,8,10] (out of 100): }\PY{l+s+si}{\PYZob{}convergence\PYZus{}list\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Results mostly converge for N1=4 and above. For N1=2, almost 70\PYZpc{} of the times,}
    \PY{c+c1}{\PYZsh{} it converges. For N1=1, it doesn\PYZsq{}t converge at all.}
    \PY{c+c1}{\PYZsh{} This is probably because the XOR problem is not linearly separable and we need a higher}
    \PY{c+c1}{\PYZsh{} number of neurons in the hidden layer to approximate the function (see universality theorem).}

\PY{k}{def} \PY{n+nf}{xor\PYZus{}weight\PYZus{}validation}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{max\PYZus{}epochs} \PY{o}{=} \PY{l+m+mi}{1}

    \PY{c+c1}{\PYZsh{} Setting initial weights and biases for xor weight validation}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.197}\PY{p}{,} \PY{l+m+mf}{0.3191}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1448}\PY{p}{,} \PY{l+m+mf}{0.3594}\PY{p}{]}\PY{p}{,}
                                \PY{p}{[}\PY{l+m+mf}{0.3099}\PY{p}{,} \PY{l+m+mf}{0.1904}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.0347}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.4861}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.4919}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.2913}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3979}\PY{p}{,} \PY{l+m+mf}{0.3581}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3378}\PY{p}{,} \PY{l+m+mf}{0.2771}\PY{p}{,} \PY{l+m+mf}{0.2859}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3329}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1401}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{reinitialize\PYZus{}weights} \PY{o}{=} \PY{k+kc}{False}

    \PY{n}{model} \PY{o}{=} \PY{n}{train\PYZus{}nn}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}

    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights1=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biases1=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights2=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biases2=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{final\PYZus{}verification}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{learning\PYZus{}rate} \PY{o}{=} \PY{l+m+mf}{0.2}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{zeta} \PY{o}{=} \PY{l+m+mf}{1.0}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{x0} \PY{o}{=} \PY{l+m+mf}{1.0}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{max\PYZus{}epochs} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.197}\PY{p}{,} \PY{l+m+mf}{0.3191}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1448}\PY{p}{,} \PY{l+m+mf}{0.3594}\PY{p}{]}\PY{p}{,}
                                \PY{p}{[}\PY{l+m+mf}{0.3099}\PY{p}{,} \PY{l+m+mf}{0.1904}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.0347}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.4861}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.4919}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.2913}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3979}\PY{p}{,} \PY{l+m+mf}{0.3581}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3378}\PY{p}{,} \PY{l+m+mf}{0.2771}\PY{p}{,} \PY{l+m+mf}{0.2859}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.3329}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1401}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
    \PY{n}{model}\PY{o}{.}\PY{n}{reinitialize\PYZus{}weights} \PY{o}{=} \PY{k+kc}{False}
    \PY{n}{model} \PY{o}{=} \PY{n}{train\PYZus{}nn}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights1=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biases1=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights2=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{weights\PYZus{}2}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biases2=}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{biases\PYZus{}2}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} Results Demo}
\PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Part 1: XOR Weights Validation}
\PY{n}{x\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
\PY{n}{y\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
\PY{n}{model} \PY{o}{=} \PY{n}{Model}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params} \PY{o}{=} \PY{n}{HyperParams}\PY{p}{(}\PY{p}{)}
\PY{n}{xor\PYZus{}weight\PYZus{}validation}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{XOR weights validation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Weights1=
[[ 0.19347555  0.31675476 -0.144748    0.36374521]
 [ 0.30686735  0.18845288 -0.03301594 -0.48859019]]
Biases1=
[[-0.32243413  0.26504268  0.27330512 -0.32503622]]
Weights2=
[[ 0.47534885]
 [-0.27642811]
 [-0.38395025]
 [ 0.34801327]]
Biases2=
[[-0.08027444]]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Part 2a: Verying alpha, zeta and x0 (Quadratic Cost Function)}
\PY{c+c1}{\PYZsh{} using quadratic cost function}

\PY{n}{model} \PY{o}{=} \PY{n}{Model}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{part\PYZus{}2a}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZhy{}Z\PYZhy{}X0 variations (Quad)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{print\PYZus{}table\PYZus{}a}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZhy{}Z\PYZhy{}X0 variations (Quad)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} Table 1}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
-----------------------------------------------------------------------

Number of convergent hyper parameter combinations = 16 (out of 27)
-----------------------------------------------------------------------

   Alpha Zeta  Xo  Final Epoch Error Convergence  # Training Epochs
0   0.1  0.5  0.5           0.049993         Yes                151
1   0.1  0.5  1.0           0.406422          No                700
2   0.1  0.5  1.5           4.049384          No                700
3   0.1  1.0  0.5           0.049455         Yes                110
4   0.1  1.0  1.0           0.049870         Yes                485
5   0.1  1.0  1.5           3.924008          No                700
6   0.1  1.5  0.5           3.996796          No                700
7   0.1  1.5  1.0           0.049971         Yes                588
8   0.1  1.5  1.5           0.062027          No                700
9   0.2  0.5  0.5           0.049036         Yes                 64
10  0.2  0.5  1.0           4.204976          No                700
11  0.2  0.5  1.5           4.093781          No                700
12  0.2  1.0  0.5           0.049674         Yes                 54
13  0.2  1.0  1.0           0.049949         Yes                236
14  0.2  1.0  1.5           0.055472          No                700
15  0.2  1.5  0.5           0.049167         Yes                555
16  0.2  1.5  1.0           0.049913         Yes                248
17  0.2  1.5  1.5           0.049957         Yes                611
18  0.3  0.5  0.5           5.313238          No                700
19  0.3  0.5  1.0           4.310545          No                700
20  0.3  0.5  1.5           4.136845          No                700
21  0.3  1.0  0.5           0.048860         Yes                 29
22  0.3  1.0  1.0           0.049617         Yes                187
23  0.3  1.0  1.5           0.049693         Yes                351
24  0.3  1.5  0.5           0.049865         Yes                 43
25  0.3  1.5  1.0           0.049675         Yes                104
26  0.3  1.5  1.5           0.049973         Yes                442
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} part 2b: Varying N1 (hidden layer neurons) (Quadratic Cost Functions)}
\PY{n}{part\PYZus{}2b}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cost\PYZus{}fn}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N1 variations (Quad)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Convergence for N1 = 1 -> 0
Convergence for N1 = 2 -> 84
Convergence for N1 = 4 -> 99
Convergence for N1 = 6 -> 100
Convergence for N1 = 8 -> 100
Convergence for N1 = 10 -> 98
Convergence results for N1 = [1,2,4,6,8,10] (out of 100): [0, 84, 99, 100, 100,
98]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Part 3a: Varying alpha, zeta and x0 (hidden layer neurons) (Cross Entropy Cost Function)}
\PY{c+c1}{\PYZsh{} using cross entropy cost ftn}
\PY{n}{model}\PY{o}{.}\PY{n}{hyper\PYZus{}params}\PY{o}{.}\PY{n}{cost\PYZus{}fn} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{part\PYZus{}2a}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZhy{}Z\PYZhy{}X0 variations (CrsEnt)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{print\PYZus{}table\PYZus{}a}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZhy{}Z\PYZhy{}X0 variations (Quad)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} Table 3}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
-----------------------------------------------------------------------

Number of convergent hyper parameter combinations = 16 (out of 27)
-----------------------------------------------------------------------

   Alpha Zeta Xo  Final Epoch Error Convergence  \# Training Epochs
0   0.1  0.5  0.5           0.049993         Yes                151
1   0.1  0.5  1.0           0.406422          No                700
2   0.1  0.5  1.5           4.049384          No                700
3   0.1  1.0  0.5           0.049455         Yes                110
4   0.1  1.0  1.0           0.049870         Yes                485
5   0.1  1.0  1.5           3.924008          No                700
6   0.1  1.5  0.5           3.996796          No                700
7   0.1  1.5  1.0           0.049971         Yes                588
8   0.1  1.5  1.5           0.062027          No                700
9   0.2  0.5  0.5           0.049036         Yes                 64
10  0.2  0.5  1.0           4.204976          No                700
11  0.2  0.5  1.5           4.093781          No                700
12  0.2  1.0  0.5           0.049674         Yes                 54
13  0.2  1.0  1.0           0.049949         Yes                236
14  0.2  1.0  1.5           0.055472          No                700
15  0.2  1.5  0.5           0.049167         Yes                555
16  0.2  1.5  1.0           0.049913         Yes                248
17  0.2  1.5  1.5           0.049957         Yes                611
18  0.3  0.5  0.5           5.313238          No                700
19  0.3  0.5  1.0           4.310545          No                700
20  0.3  0.5  1.5           4.136845          No                700
21  0.3  1.0  0.5           0.048860         Yes                 29
22  0.3  1.0  1.0           0.049617         Yes                187
23  0.3  1.0  1.5           0.049693         Yes                351
24  0.3  1.5  0.5           0.049865         Yes                 43
25  0.3  1.5  1.0           0.049675         Yes                104
26  0.3  1.5  1.5           0.049973         Yes                442
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Part 3b: Varying N1 (hidden layer neurons) (Cross Entropy Cost Function)}
\PY{n}{part\PYZus{}2b}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cost\PYZus{}fn}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{sheet\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N1 variations (CrsEnt)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Convergence for N1 = 1 -> 0
Convergence for N1 = 2 -> 61
Convergence for N1 = 4 -> 96
Convergence for N1 = 6 -> 98
Convergence for N1 = 8 -> 99
Convergence for N1 = 10 -> 100
Convergence results for N1 = [1,2,4,6,8,10] (out of 100): [0, 61, 96, 98, 99,
100]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Part 4: Weights and biases for N1 = 4, alpha = 0.2, zeta = 1.0 and x0 = 1.0 after 1 epoch}
\PY{n}{final\PYZus{}verification}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Weights1=
[[ 0.19383967  0.30895515 -0.14727152  0.36911844]
 [ 0.29881712  0.18811518 -0.02889164 -0.48928638]]
Biases1=
[[-0.30754551  0.24693804  0.25732658 -0.30887916]]
Weights2=
[[ 0.44724602]
 [-0.24360234]
 [-0.35686098]
 [ 0.32501904]]
Biases2=
[[-0.01923564]]
    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
